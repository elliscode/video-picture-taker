<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Video picture taker</title>
    <meta name="description" content="Video Picture Taker" />
    <meta name="author" content="ellis" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--<link rel="icon" type="image/png" href="../images/favicon.png" />-->
    <style>
        #camera {
            position: fixed;
            bottom: 0px;
            right: 0px;
            width: 300px;
            height: 300px;
        }

        #video {
            position: fixed;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100%;
        }

        #canvas {
            display: none;
        }

        body {
            overflow: hidden;
        }
    </style>
</head>

<body>
    <canvas id="canvas" width=320 height=240></canvas>
    <video id="camera" muted playsinline autoplay></video>

<iframe width="560" height="315" src="https://www.youtube.com/embed/5015skRvqs8?autoplay=1&playsinline=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</body>
<script>

    function handleTouchStart(evt) {
        let canvas = document.getElementById('canvas');
        let capabilities = camera.srcObject.getTracks()[0].getSettings();
        canvas.width = capabilities.width;
        canvas.height = capabilities.height;    
        let context = canvas.getContext('2d');
        context.drawImage(camera, 0, 0, canvas.width, canvas.height);
        let imageData = context.getImageData(0, 0, canvas.width, canvas.height);
        var dataURL = canvas.toDataURL('image/png');
        // create temporary link  
        var tmpLink = document.createElement('a');
        tmpLink.download = 'image.png'; // set the name of the download file 
        tmpLink.href = dataURL;

        // temporarily add link to body and initiate the download  
        document.body.appendChild(tmpLink);
        tmpLink.click();
        document.body.removeChild(tmpLink);
        return false;
    };

    function getUserMedia() {
        const constraints = {
            video: true,
        };

        return navigator.mediaDevices.getUserMedia(constraints);
    }

    document.addEventListener('touchstart', handleTouchStart, { passive: false });

    const supported = 'mediaDevices' in navigator;

    if (supported) {
        const camera = document.getElementById('camera');
        let userMedia = getUserMedia();
        userMedia.then((stream) => {
            camera.srcObject = stream;
        });
    }
</script>

</html>